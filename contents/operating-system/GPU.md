# GPU

## GPU(Graphics Processing Unit)란?

- VPU(Visual Processing Unit)라고도 불리며, 컴퓨터 시스템에서 그래픽 연산을 빠르게 처리하여 결과값을 모니터에 출력하는 연산 장치

![스크린샷 2022-06-18 17 09 58](https://user-images.githubusercontent.com/75382687/174443646-6ba98cf3-d453-4b5c-aa8b-4eb54313972e.png)

<br>

## GPU의 개념

- 그래픽 카드를 구성하는 핵심 요소(GPU ≠ 그래픽 카드)
- GPU는 임베디드 시스템, 휴대 전화, 컴퓨터, 콘솔, 인공지능, 무인 자동차, 클라우드 컴퓨팅 등에 사용된다.
- 멀티 코어로 이루어져 있으며, 대량의 연산을 병렬 처리한다.
- 그래픽과 관련된 연산을 할 때, CPU의 부담을 크게 줄일 수 있다.

<br>

## GPU의 필요성

- 초기 CPU는 컴퓨터에 입력이 들어오면 데이터를 계산, 처리하고 화면에 그려주는 일까지 모두 담당했다. 
시간이 지남에 따라, 복잡한 계산과 게임 같은 복잡한 화면을 그려야 하는 일이 발생했다. 
직렬 처리를 하는 CPU는 데이터를 처리하는 양이 많아지면서, 중요한 작업과 함께 모든 데이터를 처리하기가 힘들어졌다.
- CPU의 작업량을 분산시키기 위해 GPU가 화면을 그리는 역할을 담당하고 CPU는 중요한 작업에 집중할 수 있게 되었다.

<br>

## CPU와 GPU의 차이

- CPU는 직렬 처리에 최적화된 소수(1 ~ 128)의 고성능 코어로 구성되어 있다.
- GPU는 병렬 처리에 최적화된 다수(수백 ~ 수천)의 저성능 코어로 구성되어 있다.
- CPU는 GPU보다 적은 코어를 갖고 있지만, 각각의 코어가 GPU보다 강력한 컴퓨팅 파워를 갖고 있다.

<br>

## GPU의 핵심 기술

- 그래픽 제어
    - 렌더링(Rendering): 컴퓨터 프로그램을 사용하여 모델로부터 영상 생성
    - 셰이딩(Shading): 빛의 거리와 각도에 따라 물체 표면의 조도 변화
    - 블렌딩(Blending): 2개의 이미지 결합 표현, 투명 오브젝트 생성/제어
- 연산 제어
    - 파이프라인(Pipeline): 명령어 처리 과정을 여러 단계로 세분화하여 병렬 처리
    - 부동소수점 연산

<br>

## 그래픽 연산

### 화면 처리

> 조건: FHD 해상도 모니터(가로 1920, 세로 1080개의 픽셀), 주사율 60hz(초당 60번의 모니터 갱신이 발생한다.)
> 
- 화면을 그리기 위해서는 초당 1920 x 1080 x 60 회의 연산이 필요하다.
(초당 124,416,000 회의 연산이 필요하다.)
- GPU는 이 단순하지만 수많은 작업들을 병렬로 처리한다.

### 3D 객체 표현

> 점(Vertex): 정점(꼭짓점), 모델을 구성하는 가장 작은 단위
> 
> 선(Edge): 점과 점이 만나 이루어지는 선
> 
> 다각형(Polygon): 선과 선이 만나 이루어진 다각형, 일반적으로 모든 오브젝트는 삼각형을 이어 붙여 만든다.
> 
- 3D 객체는 수많은 Polygon들을 합쳐서 표현한 것이다.
- 화면에 표시되는 3D 객체는 수많은 Vertex들로 Polygon을 그린 것이다.
- 3D 객체의 변환은 Vertex의 벡터 또는 매트리스를 행렬 연산을 통해 그리는데, GPU는 이 단순하지만 수많은 작업들을 병렬로 처리한다.
- 예시
    - C++에서 단순 Polygon을 그리고 변환시키는 코드
        ```cpp
        void drawHead() {
        	glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);
        	glColor3f(0, 1.0, 0);
        	glBegin(GL_QUADS);
        	glVertex3i(0, 10, 0); // Vertex 생성
        	glVertex3i(2, 10, 0);
        	glVertex3i(2, 12, 0);
        	glVertex3i(0, 12, 0);
        	glEnd();
        }
        
        void drawBody() {
        	glPushMatrix();
        	glTranslatef(-2, -50, 0); // Vertex 위치 변환
        	glScalef(3.0, 5.0, 0);    // Vertex 크기 변환
        	drawHead();
        	glPopMatrix();
        }
        ```
        
    - Vertex가 변환될 때 수행되는 행렬 연산
    
      ![affine](https://user-images.githubusercontent.com/75382687/174443888-bec1dfc1-0fb6-4efc-9ca2-062b9607a421.png)



### NVIDIA CUDA

- NVIDIA사의 경우, 수백, 수천만 개의 연산을 warp라고 불리는 단위로  쪼개어 GPU의 각 코어로 전달한다.
- CPU는 데이터를 읽어오는 지연 시간이 길어지면 성능이 저하되기 때문에 주변 캐시 메모리에서 데이터를 읽어오지만, NVIDIA의 CUDA를 활용한 GPU는 지연 시간이 발생하면 바로 다음 warp의 연산을 수행한다.

<br>

## 최근 GPU의 활용

- 딥 러닝
    - 신경세포를 흉내 낸 신경망 네트워크를 사용하는 딥 러닝의 경우, 수많은 데이터를 곱셈과 덧셈처럼 단순 연산만 하기 때문에 GPU를 활용하면 효과적이다.
- 가상화폐 채굴
    - 비트코인의 경우, 채굴하기 위해서는 정해진 해시 값이 나올 때까지 임의의 숫자를 계속해서 덧셈하는  방식이기 때문에 GPU를 사용하여 계산한다.(그래픽 카드가 매우 비싸진 이유)
- 날씨 예보
    - 날씨 예보의 경우, 특정 구역을 격자 형태로 쪼개어 그 구역의 온도나 기상 상태를 파악하기 때문에 쪼개어진 수많은 구역의 데이터를 GPU를 사용하여 처리한다.
    
<br>

## 면접 대비

- CPU와 GPU의 차이점은?
